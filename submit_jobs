#!/bin/bash
#SBATCH -J keystroke_train
#SBATCH -p gpu                 # GPU partition (7 days)
#SBATCH -N 1
#SBATCH --ntasks=1
#SBATCH --gres=gpu:4
#SBATCH -t 7-00:00:00
#SBATCH -o job.out
#SBATCH -e job.err

# --- env setup ---
module purge
module load anaconda           # or module load python/3.11 if thatâ€™s how your site does it
source ~/.bashrc
conda activate keystroke       # <-- set to your conda env name

# (optional) CUDA module, only if required on your site:
# module load cuda

# sanity
echo "PYTHON: $(which python)"
python -c "import torch; print('torch', torch.__version__, 'cuda?', torch.cuda.is_available())"
nvidia-smi

# PyTorch/HF niceties
export TOKENIZERS_PARALLELISM=false
export OMP_NUM_THREADS=$(nproc)
export TORCH_USE_CUDA_DSA=1

python Trainer.py
#python synthesizeKeystrokes.py
#python accuracyTester.py
